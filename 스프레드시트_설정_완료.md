# ✅ 구글 스프레드시트 설정 완료 가이드

## 📊 제공된 스프레드시트 정보

**스프레드시트 URL**: https://docs.google.com/spreadsheets/d/1560Ltq5cWqh37D8PqdUPCW9pxEFzT8R8QT0cVqMD71Y/edit

**스프레드시트 ID**: `1560Ltq5cWqh37D8PqdUPCW9pxEFzT8R8QT0cVqMD71Y`

---

## 🚀 설정 단계

### 1단계: 스프레드시트 열기 및 헤더 설정

1. 위 URL로 스프레드시트 열기
2. 첫 번째 행(A1~G1)에 다음 헤더 입력:

| A | B | C | D | E | F | G |
|---|---|---|---|---|---|---|
| id | counselor | date | startTime | endTime | clientName | sessionNumber |

**중요**: 
- 헤더 이름은 정확히 위와 같이 입력 (대소문자 구분)
- 철자가 틀리면 데이터가 제대로 저장되지 않습니다

---

### 2단계: Apps Script 설정

1. 스프레드시트 상단 메뉴에서 **확장 프로그램** 클릭
2. **Apps Script** 선택
3. 새 탭에서 Apps Script 편집기가 열립니다

---

### 3단계: Code.gs 코드 복사

1. 프로젝트 폴더의 `Code.gs` 파일 열기
2. **전체 내용 복사** (Ctrl+A, Ctrl+C)
3. Apps Script 편집기로 돌아가기
4. 기본 코드(`function myFunction() {}`)를 **모두 삭제**
5. 복사한 코드 **붙여넣기** (Ctrl+V)

---

### 4단계: 저장

1. 상단의 **디스크 아이콘** 클릭 또는 `Ctrl+S` (Mac: `Cmd+S`)
2. 프로젝트 이름을 `상담스케줄API` 로 설정 (원하는 이름 가능)

---

### 5단계: 웹 앱 배포

#### 5-1. 배포 시작

1. Apps Script 편집기 상단 오른쪽의 **배포** 버튼 클릭
2. **새 배포** 선택

#### 5-2. 배포 설정

**배포 유형 선택:**
- 톱니바퀴 아이콘 클릭
- **웹 앱** 선택

**설정 입력:**

| 항목 | 설정 값 |
|------|---------|
| **설명** | `상담 스케줄 API` (원하는 설명) |
| **다음 사용자로 실행** | **나** 선택 ⚠️ 중요 |
| **액세스 권한** | **전체 사용자** 선택 ⚠️ 중요 |

#### 5-3. 권한 승인

1. **배포** 버튼 클릭
2. **액세스 승인** 팝업이 나타나면 **액세스 승인** 클릭
3. Google 계정 선택
4. **고급** 클릭 (보안 경고가 나타날 수 있음)
5. **[프로젝트명](으)로 이동** 클릭
6. **허용** 클릭

#### 5-4. 웹 앱 URL 복사 ⭐ 중요

1. 배포가 완료되면 **웹 앱 URL**이 표시됩니다
2. URL 형식: `https://script.google.com/macros/s/XXXXX.../exec`
3. **복사** 버튼을 클릭하여 URL을 복사하세요
4. 이 URL을 다음 단계에서 사용합니다!

---

### 6단계: 로컬 서버 환경 변수 설정

1. 프로젝트 폴더에서 `.env` 파일 열기
2. 다음과 같이 수정:

```env
# 구글 Apps Script 웹 앱 URL
GOOGLE_SCRIPT_URL=여기에_복사한_웹앱_URL_붙여넣기
```

**예시:**
```env
GOOGLE_SCRIPT_URL=https://script.google.com/macros/s/AKfycbxXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX/exec
```

**주의사항:**
- `=` 앞뒤에 공백 없어야 함
- URL 전체를 따옴표 없이 붙여넣기
- URL 끝의 `/exec`까지 포함

---

### 7단계: 서버 시작 및 테스트

1. **터미널에서 서버 시작:**
   ```bash
   cd /Users/joseph/Downloads/celender-main
   npm start
   ```

2. **브라우저 접속:**
   ```
   http://localhost:3000
   ```

3. **테스트:**
   - 스케줄 추가 버튼 클릭
   - 테스트 데이터 입력
   - 저장 클릭
   - 구글 스프레드시트에서 데이터 확인 ✅

---

## ✅ 설정 완료 체크리스트

- [ ] 스프레드시트에 헤더 입력 완료
- [ ] Apps Script 편집기에서 Code.gs 코드 붙여넣기 완료
- [ ] 코드 저장 완료
- [ ] 웹 앱 배포 완료
- [ ] 권한 승인 완료
- [ ] 웹 앱 URL 복사 완료
- [ ] .env 파일에 URL 입력 완료
- [ ] 서버 시작 및 테스트 완료

---

## 🔍 문제 해결

### "액세스 권한이 거부되었습니다"

**해결 방법:**
1. Apps Script 편집기로 돌아가기
2. **배포 관리** 클릭
3. 현재 배포의 연필 아이콘(편집) 클릭
4. **액세스 권한**을 **전체 사용자**로 변경
5. **버전 배포** 클릭

---

### "데이터가 저장되지 않습니다"

**확인 사항:**
1. 스프레드시트 헤더가 정확한지 확인
   - `id`, `counselor`, `date`, `startTime`, `endTime`, `clientName`, `sessionNumber`
2. Apps Script 실행 로그 확인
   - Apps Script 편집기 > 실행 > 실행 로그 보기
3. .env 파일의 URL이 올바른지 확인
4. 서버 터미널에서 에러 메시지 확인

---

### "웹 앱 URL을 찾을 수 없습니다"

**해결 방법:**
1. Apps Script 편집기로 돌아가기
2. **배포** > **배포 관리** 클릭
3. 현재 배포 항목에서 **URL 복사** 클릭

---

## 📝 참고 사항

### 스프레드시트 공유

팀원들과 스프레드시트를 공유하려면:

1. 스프레드시트 우측 상단 **공유** 버튼 클릭
2. 팀원의 이메일 주소 입력
3. 권한 선택: **편집자** (권장)
4. **전송** 클릭

### 웹 앱 URL 보안

- 웹 앱 URL은 외부에 노출하지 마세요
- 팀원들에게만 공유하세요
- URL이 유출되면 `.env` 파일의 URL을 변경하고 새로 배포하세요

---

## 🎉 완료!

이제 구글 스프레드시트와 연동된 상담 스케줄 관리 시스템을 사용할 수 있습니다!

**다음 단계:**
1. 팀원들에게 `http://localhost:3000` URL 공유
2. 또는 같은 네트워크에서 `http://[내컴퓨터IP]:3000` 공유
3. 스프레드시트 편집 권한 공유

---

**문제가 있나요?**
- `구글스프레드시트_설정가이드.md` 참고
- 서버 터미널 로그 확인
- 브라우저 개발자 도구(F12) Console 확인

---

© 2026 상담 스케줄 관리 시스템
